---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
export async function getStaticPaths() {
  const posts = (await getCollection('blog')).filter(p => !p.data?.draft);
  return posts.map((p) => ({ params: { slug: p.slug }, props: { post: p } }));
}
const { post } = Astro.props;
const rendered = await post.render();
const Content = rendered?.Content;
const SafeContent = Content ?? ((_) => (<p class="text-sm text-zinc-600 italic">(No content found for this post.)</p>));
const { title, description, date, hero, tags } = post.data;
---
<BaseLayout title={title} description={description}>
  <article class="max-w-3xl mx-auto prose prose-zinc lg:prose-lg">
    <header class="not-prose mb-6">
      <h1 class="text-4xl font-bold">{title}</h1>
      <div class="text-xs text-zinc-600">{new Date(date).toLocaleDateString()}</div>
      {hero && <img src={hero} alt="" class="w-full rounded-xl border my-4" />}
      {description && <p class="text-zinc-700">{description}</p>}
      {tags && <div class="flex gap-2 mt-2 text-xs">{tags.map(t => <span class="px-2 py-1 rounded-full bg-black/5">{t}</span>)}</div>}
    </header>
    <div class="prose-invert:prose-0">
      <SafeContent />
    </div>
  </article>
</BaseLayout>
